<!-- <p>novo-relatorio works!</p> -->
<nb-card>
  <nb-card-body>
    <nb-stepper #stepper>
      <!-- /*********************/ STEP #1 /*********************/ -->
      <nb-step label="Selecione a Data" [stepControl]="calendarForm">
        <form [formGroup]="calendarForm">
          <span>selecione a data</span>
          <nb-calendar
            [date]="date"
            (dateChange)="handleCalendarDateChanges($event)"
          ></nb-calendar>
          <h4 class="selected-date">{{ date | date }}</h4>
          <button nbButton status="success" [disabled]="!date" nbStepperNext>
            <nb-icon icon="arrow-right"></nb-icon>
            Próximo
          </button>
        </form>
      </nb-step>

      <!-- /*********************/ STEP #2 /*********************/ -->
      <nb-step label="Relatório" [stepControl]="reportForm">
        <div
          class="consulta-form"
          [formGroup]="consulta"
          *ngFor="let consulta of getConsultasControls(); let i = index"
        >
          <div class="button-wrapper">
            <button
              *ngIf="i > 0"
              nbButton
              shape="round"
              status="danger"
              (click)="removeConsulta(i)"
            >
              <nb-icon icon="close-outline"></nb-icon>
            </button>
          </div>

          <div class="select-wrapper">
            <nb-select-label>Paciente</nb-select-label>
            <nb-select
              formControlName="nomePaciente"
              size="small"
              [status]="
                consulta.get('nomePaciente').valid
                  ? 'success'
                  : consulta.get('nomePaciente').dirty
                  ? 'danger'
                  : 'basic'
              "
            >
              <!-- [status]="getFieldStatus(i, 'nomePaciente')" -->
              <nb-option
                *ngFor="let cliente of clientes"
                [value]="cliente.nome"
                >{{ cliente.nome }}</nb-option
              >
            </nb-select>
          </div>
          <!-- </nb-form-field> -->

          <!-- <nb-form-field> -->
          <div class="select-wrapper">
            <nb-select-label>Horário</nb-select-label>
            <nb-select
              formControlName="horario"
              status="basic"
              size="small"
              [status]="
                consulta.get('horario').valid
                  ? 'success'
                  : consulta.get('horario').dirty
                  ? 'danger'
                  : 'basic'
              "
            >
              <!-- [status]="getFieldStatus('horario')" -->
              <nb-option *ngFor="let hora of horarios" [value]="hora">
                {{ hora }}
              </nb-option>
            </nb-select>
            <!-- </nb-form-field> -->
          </div>
          <div class="select-wrapper">
            <!-- <nb-form-field> -->
            <nb-select-label>Modalidade</nb-select-label>
            <nb-select
              formControlName="modalidade"
              [selected]="modalidades[0]"
              size="small"
              [status]="
                consulta.get('modalidade').valid
                  ? 'success'
                  : consulta.get('modalidade').dirty
                  ? 'danger'
                  : 'basic'
              "
            >
              <!-- [status]="getFieldStatus('modalidade')" -->
              <nb-option
                *ngFor="let modalidade of modalidades"
                [value]="modalidade"
              >
                {{ modalidade }}
              </nb-option>
            </nb-select>
            <!-- </nb-form-field> -->
          </div>
          <div class="button-wrapper">
            <button
              nbButton
              shape="round"
              status="success"
              (click)="addConsulta()"
            >
              <nb-icon icon="plus-outline"></nb-icon>
            </button>
          </div>
        </div>

        <button nbButton nbStepperPrevious>
          <nb-icon icon="arrow-back-outline"></nb-icon>
          Voltar
        </button>

        <button
          nbButton
          status="success"
          (click)="handleFormData($event)"
          nbStepperNext
        >
          <nb-icon icon="arrow-right"></nb-icon>
          Próximo
        </button>
      </nb-step>

      <!-- /*********************/ STEP #3 /*********************/ -->
      <nb-step label="revisao" [stepControl]="revisionTable">
        <ng-template #revisao>
          <div>
            step number three
          </div>
        </ng-template>
        <button nbButton nbStepperPrevious>
          <nb-icon icon="arrow-back-outline"></nb-icon>
          Voltar
        </button>

        <button nbButton status="success" nbStepperNext>
          <nb-icon icon="arrow-right"></nb-icon>
          Próximo
        </button>
      </nb-step>
    </nb-stepper>
  </nb-card-body>
</nb-card>
