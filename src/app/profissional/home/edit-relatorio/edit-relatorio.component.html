<ng-container *ngIf="editForm; else default">
  <div class="component-container">
    <button nbButton ghost (click)="destroyEditForm()">
      <nb-icon icon="arrow-back"></nb-icon>
    </button>

    <div class="relatorio-default-data">
      <div *ngFor="let consulta of reportConsultas">
        {{ consulta.horario }} {{ consulta.nomePaciente }}
        {{ consulta.modalidade }}
      </div>
    </div>

    <form [formGroup]="editForm">
      <label>Data Relatório</label>
      <input
        id="data-relatorio"
        type="text"
        nbInput
        formControlName="dataRelatorio"
      />
      <!-- [defaultValue]="reportDate | date: 'fullDate'" -->

      <div
        class="consulta-form"
        [formGroup]="consulta"
        *ngFor="let consulta of getConsultasControls(); let i = index"
      >
        <div class="button-wrapper">
          <button
            nbButton
            shape="round"
            status="danger"
            (click)="removeConsultaFormGroup(i)"
          >
            <nb-icon icon="close-outline"></nb-icon>
          </button>
        </div>

        <div class="select-wrapper horario">
          <nb-select-label>Horário</nb-select-label>
          <nb-select formControlName="horario" status="basic" size="small">
            <nb-option *ngFor="let hora of horarios" [value]="hora">
              {{ hora }}
            </nb-option>
          </nb-select>
        </div>

        <div class="select-wrapper nome-paciente">
          <nb-select-label>Paciente {{ i + 1 }}</nb-select-label>
          <nb-select
            formControlName="nomePaciente"
            size="small"
            [id]="'nomePaciente-' + i"
            [status]="
              consulta.get('nomePaciente').valid
                ? 'success'
                : consulta.get('nomePaciente').dirty
                ? 'danger'
                : 'basic'
            "
          >
            <!-- [value]="cliente.nome + ' ' + cliente.origem + ' ' + cliente.id" -->
            <nb-option
              *ngFor="let cliente of userClientes; let j = index"
              [value]="cliente.nome"
              (click)="findClienteData(cliente.id, i)"
            >
              {{ cliente.nome }}
              <!-- <span style="display: none">
                {{ cliente.origem + " " + cliente.id }}
              </span> -->
            </nb-option>
          </nb-select>
        </div>

        <div class="select-wrapper modalidade">
          <nb-select-label>Modalidade</nb-select-label>
          <nb-select formControlName="modalidade" size="small">
            <nb-option
              *ngFor="let modalidade of modalidades"
              [value]="modalidade"
            >
              {{ modalidade }}
            </nb-option>
          </nb-select>
        </div>
        <div
          *ngIf="i + 1 === getConsultasControls().length"
          class="button-wrapper add"
        >
          <button
            nbButton
            shape="round"
            status="success"
            (click)="addConsultaFormGroup()"
          >
            <nb-icon icon="plus-outline"></nb-icon>
          </button>
        </div>

        <!-- </div> -->
      </div>

      <div class="submit-btns-container">
        <button nbButton outline status="success" (click)="saveReportChanges()">
          <nb-icon outline icon="edit-2-outline"></nb-icon> Salvar alterações
        </button>

        <button nbButton outline status="danger" (click)="deleteReport()">
          <nb-icon icon="trash-outline"></nb-icon> Apagar Relatório
        </button>
      </div>
    </form>
    <div
      *ngIf="getConsultasControls()?.length === 0"
      class="button-wrapper add no-consultas"
    >
      <button
        nbButton
        shape="round"
        status="success"
        (click)="addConsultaFormGroup()"
      >
        <nb-icon icon="plus-outline"></nb-icon>
      </button>
      <span style="color: #01a26c"> criar consulta</span>
    </div>
  </div>
</ng-container>
<ng-template #default>
  <span>clique para ver detalhes</span>
</ng-template>
